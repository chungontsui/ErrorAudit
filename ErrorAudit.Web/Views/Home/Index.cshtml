@{
	ViewBag.Title = "Home Page";
}

<div class="row">
	<div class="col-md-2">
		<span class="glyphicon glyphicon-arrow-left navArrow"></span>
	</div>
	<div class="col-md-8">

		<div style="margin-top:10%" class="section" id="ErrorTypeChooser">
			<div class="form-group">
				<label for="ScriptNumber" style ="font-size: 50px;">Script Number {{greeting}}</label>
				<input type="number" style ="font-size: 60px; height: 80px;"class="form-control" id="ScriptNumber" placeholder="Enter Script Number">
			</div>
			<button type="button" class="btn btn-primary btn-lg btn-block errorType" style="height:100px" data-errortype="EntryErrors" onclick="ShowSectionHideOthers('EntryErrors')">Entry</button>
			<button type="button" class="btn btn-secondary btn-lg btn-block errorType" style="height:100px" data-errortype="DispensingErrors" onclick="ShowSectionHideOthers('DispensingErrors')">Dispensing</button>
		</div>

		<div class="container section" id="EntryErrors" style="margin-top:20pt; display:none">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Entry Errors</h3>
				</div>
				<div class="panel-body">
					<div class="col-md-6">
						<button type="button" class="btn btn-primary btn-lg btn-block error">Incorrect Directions</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error">History not checked</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error">Dose innappropriate</button>
					</div>
					<div class="col-md-6">
						<button type="button" class="btn btn-primary btn-lg btn-block error">Incorrect Brand Choosen</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error">Incorrect Quantity/Period Of Supply</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error">Incorreect Calculations</button>
					</div>
					<div class="col-md-12" style="text-align: center;">
						<button type="button" style="margin-top: 20px; padding-left: 60px; padding-right: 60px;" class="btn btn-lg btn-success error" onclick="ShowSectionHideOthers('ProcessingStaff')">Next</button>
					</div>
				</div>
			</div>
		</div>

		<div class="container section" id="DispensingErrors" style="margin-top:20pt; display:none">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Dispensing Errors</h3>
				</div>
				<div class="panel-body">
					<div class="col-md-6">
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Incorrect Medicine</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Incorrect Strength</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Incorrect Quantity</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Correct Product Form</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Incorrect Brand</button>
					</div>
					<div class="col-md-6">
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Interactions Identified</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Dose Inappropriate</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Drug Omission</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Interactions Identified</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Incorrect Patient Supplied</button>
						<button type="button" class="btn btn-primary btn-lg btn-block error" onclick="ShowSectionHideOthers('ProcessingStaff')">Miscellaneous</button>
					</div>
				</div>
			</div>

		</div>

		<div class="container section" id="ProcessingStaff" style="margin-top:20pt; display:none">
			<div class="row">
				<div class="col-md-12">
					<div class="panel panel-danger">
						<div class="panel-heading">
							<h1 class="panel-title">Processing Staff</h1>
						</div>
						<div class="panel-body">
							<form>
								<div class="form-group">
									<label for="exampleFormControlSelect1" style="font-size: 3.25rem;">Enter:</label>
									<select class="form-control form-control-lg pstaff" id="ProcessingStaffEnter" style="font-size: 3.25rem; height:50px">
										<option>Please Select</option>
										<option>Raf</option>
										<option>Jeff</option>
										<option>Fiona</option>
										<option>Warren</option>
										<option>Leanne</option>
									</select>
								</div>

								<div class="form-group">
									<label for="exampleFormControlSelect1" style="font-size: 3.25rem;">Dispensing:</label>
									<select class="form-control form-control-lg pstaff" id="ProcessingStaffDispensing" style="font-size: 3.25rem; height:50px">
										<option>Please Select</option>
										<option>Raf</option>
										<option>Jeff</option>
										<option>Fiona</option>
										<option>Warren</option>
										<option>Leanne</option>
									</select>
								</div>

								<div class="form-group">
									<label for="exampleFormControlSelect1" style="font-size: 3.25rem;">Check:</label>
									<select class="form-control form-control-lg pstaffLast" id="ProcessingStaffChecked" style="font-size: 3.25rem; height:50px" onchange="ShowSectionHideOthers('NoticedStaff')">
										<option>Please Select</option>
										<option>Raf</option>
										<option>Jeff</option>
										<option>Fiona</option>
										<option>Warren</option>
										<option>Leanne</option>
									</select>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>

		</div>

		<div class="container section" id="NoticedStaff" style="margin-top:20pt; display:none">
			<div class="row">
				<div class="col-md-12">
					<div class="panel panel-warning">
						<div class="panel-heading">
							<h3 class="panel-title">Noticed Staff</h3>
						</div>
						<div class="panel-body">
							<form>
								<div class="form-group">
									<label for="exampleFormControlSelect1" style="font-size: 3.25rem;">Enter:</label>
									<select class="form-control form-control-lg nstaff" id="NoticedStaffEnter" style="font-size: 3.25rem; height:50px">
										<option>Please Select</option>
										<option>Raf</option>
										<option>Jeff</option>
										<option>Fiona</option>
										<option>Warren</option>
										<option>Leanne</option>
									</select>
								</div>

								<div class="form-group">
									<label for="exampleFormControlSelect1" style="font-size: 3.25rem;">Dispensing:</label>
									<select class="form-control form-control-lg nstaff" id="NoticedStaffDispensing" style="font-size: 3.25rem; height:50px">
										<option>Please Select</option>
										<option>Raf</option>
										<option>Jeff</option>
										<option>Fiona</option>
										<option>Warren</option>
										<option>Leanne</option>
									</select>
								</div>

								<div class="form-group">
									<label for="exampleFormControlSelect1" style="font-size: 3.25rem;">Check:</label>
									<select class="form-control form-control-lg nstaffLast" id="NoticedStaffChecked" style="font-size: 3.25rem; height:50px" onchange="ShowSectionHideOthers('Outcomes')">
										<option>Please Select</option>
										<option>Raf</option>
										<option>Jeff</option>
										<option>Fiona</option>
										<option>Warren</option>
										<option>Leanne</option>
									</select>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container section" id="Outcomes" style="margin-top:20pt; display:none">
			<div class="panel panel-success">
				<div class="panel-heading">
					<h3 class="panel-title">Action</h3>
				</div>
				<div class="panel-body">
					<div class="col-md-6">
						<button type="button" class="btn btn-success btn-lg btn-block outcome" onclick="ShowSectionHideOthers('ErrorTypeChooser')">Fixed Error</button>
						<button type="button" class="btn btn-success btn-lg btn-block outcome"  onclick="ShowSectionHideOthers('ErrorTypeChooser')">Prescriber Notified</button>
					</div>
					<div class="col-md-6">
						<button type="button" class="btn btn-success btn-lg btn-block outcome" onclick="ShowSectionHideOthers('ErrorTypeChooser')">Dosage Corrected</button>
						<button type="button" class="btn btn-success btn-lg btn-block outcome" onclick="ShowSectionHideOthers('ErrorTypeChooser')">Prescription Corrected</button>
					</div>
				</div>
			</div>
			@*<button type="button" class="btn btn-success btn-lg btn-block" onclick="ShowSectionHideOthers('ErrorTypeChooser')">Complete</button>*@
		</div>
	</div>
	<div class="col-md-2">
		<span class="glyphicon glyphicon-arrow-right navArrow"></span>
	</div>
</div>
<script>

	var data = {
		ScriptNumber: "",
		error: [],
		ProcessingStaffEnter: "",
		ProcessingStaffDispensing: "",
		ProcessingStaffChecked: "",
		NoticedStaffEnter: "",
		NoticedStaffDispensing: "",
		NoticedStaffChecked: "",
		Outcome: ""
	}

	$(document).ready(function () {

		$("button.errorType").each(
			function () {
				$(this).on("click", function () {
					AddToData("ScriptNumber", $("#ScriptNumber").val());
					var errorType = $(this).attr("data-errortype");
					ShowSectionHideOthers(errorType);
				});
			}
		);

		$("button.error").each(
			function () {
				$(this).on("click", function () {
					//ProcessValue("error", $(this).text(), "ProcessingStaff"); 
					this.data.error.push($(this).text());
				});
			}
		);

		$("select.pstaff").each(function () {
			$(this).change(function () { AddToData($(this).attr("id"), $(this).val()); });
		});

		$("select.pstaffLast").each(function () {
			$(this).change(function () { ProcessValue($(this).attr("id"), $(this).val(), "NoticedStaff"); });
		});

		$("select.nstaff").each(function () {
			$(this).change(function () { AddToData($(this).attr("id"), $(this).val()); });
		});

		$("select.nstaffLast").each(function () {
			$(this).change(function () { ProcessValue($(this).attr("id"), $(this).val(), "Outcomes"); });
		});

		$("button.outcome").each(
			function () {
				$(this).on("click", function () {
					ProcessValue("Outcome", $(this).text(), "ErrorTypeChooser");
					SubmitData();
				});
			}
		);
	});

	function ProcessValue(section, value, nextSection)
	{
		AddToData(section, value);
		ShowSectionHideOthers(nextSection);
	}

	function AddToData(section, value)
	{
		data[section] = value;
	}

	function ShowSectionHideOthers(type) {
		$("div.section").each(function (index) {
			//console.log(index + ": " + $(this).text());
			if ($(this)[0].id != type) {
				$(this).css("display", "none");
			}
			else
			{
				$(this).css("display", "block");
			}
		});
	}

	function SubmitData()
	{
		$.ajax({
			url: window.location.origin + "/api/ErrorAudit",
			method: "POST",
			data: this.data,
			success: function (result) {
				//$("#div1").html(result);
				ShowSectionHideOthers("ErrorTypeChooser");
			}
		});
	}

</script>
